<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Applicant Matching API Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .test-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
        }
        .response-area {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            padding: 1rem;
            min-height: 200px;
            font-family: monospace;
            white-space: pre-wrap;
            overflow-y: auto;
        }
        .loading {
            color: #6c757d;
        }
        .success {
            color: #198754;
        }
        .error {
            color: #dc3545;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="mb-4">AI Applicant Matching API Test</h1>
        
        <!-- Test 1: Get Applicant Profile -->
        <div class="test-section">
            <h3>Test 1: Get Applicant Profile</h3>
            <p>Get detailed applicant profile with AI matching insights for a specific job.</p>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="userId" class="form-label">User ID:</label>
                    <input type="text" class="form-control" id="userId" value="688f612e29bf43153df62360">
                    <small class="text-muted">PhucLe - lenguyenthienphuc2004@gmail.com</small>
                </div>
                <div class="col-md-6">
                    <label for="jobId1" class="form-label">Job ID:</label>
                    <input type="text" class="form-control" id="jobId1" value="692abb72d3f7d9dfca7aaf40">
                    <small class="text-muted">Senior UI/UX Designer</small>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="testApplicantProfile()">Test Applicant Profile</button>
            <button class="btn btn-secondary ms-2" onclick="clearResponse('response1')">Clear</button>
            
            <div class="mt-3">
                <h5>Response:</h5>
                <div id="response1" class="response-area">Click "Test Applicant Profile" to see the response...</div>
            </div>
        </div>

        <!-- Test 2: Get Matching Applicants for Job -->
        <div class="test-section">
            <h3>Test 2: Get Matching Applicants for Job</h3>
            <p>Get AI-powered matching applicants for a specific job posting.</p>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="jobId2" class="form-label">Job ID:</label>
                    <input type="text" class="form-control" id="jobId2" value="692abb72d3f7d9dfca7aaf40">
                    <small class="text-muted">Senior UI/UX Designer</small>
                </div>
                <div class="col-md-6">
                    <label for="limit1" class="form-label">Limit:</label>
                    <input type="number" class="form-control" id="limit1" value="10" min="1" max="50">
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="testMatchingApplicants()">Test Matching Applicants</button>
            <button class="btn btn-secondary ms-2" onclick="clearResponse('response2')">Clear</button>
            
            <div class="mt-3">
                <h5>Response:</h5>
                <div id="response2" class="response-area">Click "Test Matching Applicants" to see the response...</div>
            </div>
        </div>

        <!-- Test 3: Get All Jobs Recommendations -->
        <div class="test-section">
            <h3>Test 3: Get All Jobs Recommendations</h3>
            <p>Get AI-powered applicant recommendations for all jobs of a business.</p>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="businessId" class="form-label">Business ID:</label>
                    <input type="text" class="form-control" id="businessId" value="692abb72d3f7d9dfca7aaf3e">
                    <small class="text-muted">Business with design jobs</small>
                </div>
                <div class="col-md-6">
                    <label for="limit2" class="form-label">Limit per job:</label>
                    <input type="number" class="form-control" id="limit2" value="5" min="1" max="20">
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="testAllRecommendations()">Test All Recommendations</button>
            <button class="btn btn-secondary ms-2" onclick="clearResponse('response3')">Clear</button>
            
            <div class="mt-3">
                <h5>Response:</h5>
                <div id="response3" class="response-area">Click "Test All Recommendations" to see the response...</div>
            </div>
        </div>

        <!-- API Info -->
        <div class="test-section">
            <h3>API Information</h3>
            <div class="row">
                <div class="col-md-6">
                    <h5>Python FastAPI Endpoints (Port 8000)</h5>
                    <ul>
                        <li><code>GET /api/applicant-profile/{user_id}?job_id={job_id}</code></li>
                        <li><code>GET /api/applicant-matching/{job_id}</code></li>
                        <li><code>GET /api/applicant-matching/all/{business_id}</code></li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5>Node.js Express Endpoints (Port 3000)</h5>
                    <ul>
                        <li><code>GET /business/api/applicant/{userId}/profile</code></li>
                        <li><code>GET /business/api/job/{jobId}/matching-applicants</code></li>
                        <li><code>GET /business/api/matching-applicants/all</code></li>
                    </ul>
                </div>
            </div>
            <div class="alert alert-info">
                <strong>Note:</strong> The Python backend acts as a proxy to the Node.js AI matching service. 
                Internal service communication uses API key authentication.
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8000';

        async function makeRequest(url, responseElementId) {
            const responseElement = document.getElementById(responseElementId);
            
            try {
                responseElement.textContent = 'Loading...';
                responseElement.className = 'response-area loading';
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                responseElement.textContent = JSON.stringify(data, null, 2);
                responseElement.className = 'response-area ' + (response.ok ? 'success' : 'error');
                
            } catch (error) {
                responseElement.textContent = 'Error: ' + error.message;
                responseElement.className = 'response-area error';
            }
        }

        function testApplicantProfile() {
            const userId = document.getElementById('userId').value;
            const jobId = document.getElementById('jobId1').value;
            
            if (!userId || !jobId) {
                alert('Please enter both User ID and Job ID');
                return;
            }
            
            const url = `${API_BASE_URL}/api/applicant-profile/${userId}?job_id=${jobId}`;
            makeRequest(url, 'response1');
        }

        function testMatchingApplicants() {
            const jobId = document.getElementById('jobId2').value;
            
            if (!jobId) {
                alert('Please enter Job ID');
                return;
            }
            
            const url = `${API_BASE_URL}/api/applicant-matching/${jobId}`;
            makeRequest(url, 'response2');
        }

        function testAllRecommendations() {
            const businessId = document.getElementById('businessId').value;
            
            if (!businessId) {
                alert('Please enter Business ID');
                return;
            }
            
            const url = `${API_BASE_URL}/api/applicant-matching/all/${businessId}`;
            makeRequest(url, 'response3');
        }

        function clearResponse(elementId) {
            const element = document.getElementById(elementId);
            element.textContent = 'Response cleared. Click a test button to see results...';
            element.className = 'response-area';
        }

        // Sample data for testing
        document.addEventListener('DOMContentLoaded', function() {
            console.log('AI Applicant Matching API Test Page Loaded');
        });
    </script>
</body>
</html>
